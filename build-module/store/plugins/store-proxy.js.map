{"version":3,"sources":["../../../src/store/plugins/store-proxy.js"],"names":["storeProxy","registry","pluginOptions","selectProxies","dispatchProxies","getProxy","original","proxied","TypeError","proxy","Object","keys","forEach","selectorName","result","undefined","select","storeKey","dispatch","addSelectProxy","fromStore","toStore","addDispatchProxy","removeSelectProxy","removeDispatchProxy"],"mappings":";;;;;;AAAA,SAASA,UAAT,CAAqBC,QAArB,EAA+BC,aAA/B,EAA+C;AAC9C,MAAMC,aAAa,GAAG,EAAtB;AACA,MAAMC,eAAe,GAAG,EAAxB;;AAEA,WAASC,QAAT,CAAmBC,QAAnB,EAA6BC,OAA7B,EAAuC;AACtC,QAAKD,QAAQ,KAAKC,OAAlB,EAA4B;AAC3B,YAAM,IAAIC,SAAJ,CAAe,oCAAf,CAAN;AACA;;AAED,QAAMC,KAAK,qBAAQH,QAAR,CAAX,CALsC,CAOtC;AACA;;;AACAI,IAAAA,MAAM,CAACC,IAAP,CAAaJ,OAAb,EAAuBK,OAAvB,CAAgC,UAAEC,YAAF,EAAoB;AACnD,UAAKP,QAAQ,CAAEO,YAAF,CAAb,EAAgC;AAC/BJ,QAAAA,KAAK,CAAEI,YAAF,CAAL,GAAwB,YAAe;AACtC,cAAMC,MAAM,GAAGP,OAAO,CAAEM,YAAF,CAAP,OAAAN,OAAO,YAAtB;;AAEA,cAAKO,MAAM,KAAKC,SAAhB,EAA4B;AAC3B,mBAAOD,MAAP;AACA,WALqC,CAOtC;;;AACA,iBAAO;AAAA,mBAAeR,QAAQ,CAAEO,YAAF,CAAR,OAAAP,QAAQ,YAAvB;AAAA,WAAP;AACA,SATD;AAUA;AACD,KAbD;AAeA,WAAOG,KAAP;AACA;;AAED,SAAO;AACNO,IAAAA,MADM,kBACEC,QADF,EACa;AAClB,UAAKd,aAAa,CAAEc,QAAF,CAAlB,EAAiC;AAChC,eAAOd,aAAa,CAAEc,QAAF,CAApB;AACA;;AAED,aAAOhB,QAAQ,CAACe,MAAT,CAAiBC,QAAjB,CAAP;AACA,KAPK;AAQNC,IAAAA,QARM,oBAQID,QARJ,EAQe;AACpB,UAAKb,eAAe,CAAEa,QAAF,CAApB,EAAmC;AAClC,eAAOb,eAAe,CAAEa,QAAF,CAAtB;AACA;;AAED,aAAOhB,QAAQ,CAACiB,QAAT,CAAmBD,QAAnB,CAAP;AACA,KAdK;AAeNE,IAAAA,cAfM,0BAeUC,SAfV,EAeqBC,OAfrB,EAe+B;AACpClB,MAAAA,aAAa,CAAEiB,SAAF,CAAb,GAA6Bf,QAAQ,CAAEJ,QAAQ,CAACe,MAAT,CAAiBI,SAAjB,CAAF,EAAgCnB,QAAQ,CAACe,MAAT,CAAiBK,OAAjB,CAAhC,CAArC;AACA,KAjBK;AAkBNC,IAAAA,gBAlBM,4BAkBYF,SAlBZ,EAkBuBC,OAlBvB,EAkBiC;AACtCjB,MAAAA,eAAe,CAAEgB,SAAF,CAAf,GAA+Bf,QAAQ,CAAEJ,QAAQ,CAACiB,QAAT,CAAmBE,SAAnB,CAAF,EAAkCnB,QAAQ,CAACiB,QAAT,CAAmBG,OAAnB,CAAlC,CAAvC;AACA,KApBK;AAqBNE,IAAAA,iBArBM,6BAqBaH,SArBb,EAqByB;AAC9B,aAAOjB,aAAa,CAAEiB,SAAF,CAApB;AACA,KAvBK;AAwBNI,IAAAA,mBAxBM,+BAwBeJ,SAxBf,EAwB2B;AAChC,aAAOhB,eAAe,CAAEgB,SAAF,CAAtB;AACA;AA1BK,GAAP;AA4BA;;AAED,eAAepB,UAAf","sourcesContent":["function storeProxy( registry, pluginOptions ) {\n\tconst selectProxies = {};\n\tconst dispatchProxies = {};\n\n\tfunction getProxy( original, proxied ) {\n\t\tif ( original === proxied ) {\n\t\t\tthrow new TypeError( 'You cannot proxy a store to itself' );\n\t\t}\n\n\t\tconst proxy = { ...original };\n\n\t\t// For each selector in the proxied one that exists in the original, replace it with a proxy function that first goes to the proxy selector and then\n\t\t// falls through to the original if it returns undefined\n\t\tObject.keys( proxied ).forEach( ( selectorName ) => {\n\t\t\tif ( original[ selectorName ] ) {\n\t\t\t\tproxy[ selectorName ] = ( ...args ) => {\n\t\t\t\t\tconst result = proxied[ selectorName ]( ...args );\n\n\t\t\t\t\tif ( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Fall through to original\n\t\t\t\t\treturn ( ...args ) => original[ selectorName ]( ...args );\n\t\t\t\t};\n\t\t\t}\n\t\t} );\n\n\t\treturn proxy;\n\t}\n\n\treturn {\n\t\tselect( storeKey ) {\n\t\t\tif ( selectProxies[ storeKey ] ) {\n\t\t\t\treturn selectProxies[ storeKey ];\n\t\t\t}\n\n\t\t\treturn registry.select( storeKey );\n\t\t},\n\t\tdispatch( storeKey ) {\n\t\t\tif ( dispatchProxies[ storeKey ] ) {\n\t\t\t\treturn dispatchProxies[ storeKey ];\n\t\t\t}\n\n\t\t\treturn registry.dispatch( storeKey );\n\t\t},\n\t\taddSelectProxy( fromStore, toStore ) {\n\t\t\tselectProxies[ fromStore ] = getProxy( registry.select( fromStore ), registry.select( toStore ) );\n\t\t},\n\t\taddDispatchProxy( fromStore, toStore ) {\n\t\t\tdispatchProxies[ fromStore ] = getProxy( registry.dispatch( fromStore ), registry.dispatch( toStore ) );\n\t\t},\n\t\tremoveSelectProxy( fromStore ) {\n\t\t\tdelete selectProxies[ fromStore ];\n\t\t},\n\t\tremoveDispatchProxy( fromStore ) {\n\t\t\tdelete dispatchProxies[ fromStore ];\n\t\t},\n\t};\n}\n\nexport default storeProxy;\n"],"file":"store-proxy.js"}