{"version":3,"sources":["../../../src/components/block-editor/index.js"],"names":["withDispatch","KeyboardShortcuts","rawShortcut","BlockEditorKeyboardShortcuts","EditorNotices","VisualEditor","TextEditor","FullscreenMode","BlockEditor","props","isEditing","editorMode","children","undo","redo","primary","primaryShift","dispatch","_ownProps","select","hasPeers","maybeUndo","actionCreator","noticeId","removeNotice","createNotice","id"],"mappings":";;AAAA;AACA;AACA;AACA,SAASA,YAAT,QAA6B,iBAA7B;AACA,SAASC,iBAAT,QAAkC,uBAAlC;AACA,SAASC,WAAT,QAA4B,qBAA5B;AACA,SAASC,4BAAT,QAA6C,yBAA7C;AACA,SAASC,aAAT,QAA8B,mBAA9B;AAEA;AACA;AACA;;AAEA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,OAAOC,UAAP,MAAuB,eAAvB;AACA,OAAOC,cAAP,MAA2B,mBAA3B;AACA,OAAO,cAAP;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,WAAT,CAAsBC,KAAtB,EAA8B;AAC7B,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA,UAAb;AAAyBC,IAAAA,QAAzB;AAAmCC,IAAAA,IAAnC;AAAyCC,IAAAA;AAAzC,MAAkDL,KAAxD;AAEA,SACC,8BACC,cAAC,cAAD,OADD,EAEC,cAAC,aAAD,OAFD,EAIGC,SAAS,IACV,8BACC,cAAC,4BAAD,OADD,EAEC,cAAC,4BAAD,CAA8B,QAA9B,OAFD,CALF,EAWC,cAAC,iBAAD;AACC,IAAA,UAAU,EAAG,KADd;AAEC,IAAA,SAAS,EAAG;AACX,OAAER,WAAW,CAACa,OAAZ,CAAqB,GAArB,CAAF,GAAgCF,IADrB;AAEX,OAAEX,WAAW,CAACc,YAAZ,CAA0B,GAA1B,CAAF,GAAqCF;AAF1B;AAFb,KAOGH,UAAU,KAAK,QAAf,IAA2B,cAAC,YAAD,OAP9B,EAQGA,UAAU,KAAK,MAAf,IAAyB,cAAC,UAAD,OAR5B,CAXD,EAsBGC,QAtBH,CADD;AA0BA;;AAED,eAAeZ,YAAY,CAAE,CAAEiB,QAAF,EAAYC,SAAZ,EAAuB;AAAEC,EAAAA;AAAF,CAAvB,KAAuC;AACnE,QAAMC,QAAQ,GAAGD,MAAM,CAAE,iBAAF,CAAN,CAA4BC,QAA7C;AACA,QAAM;AAAEN,IAAAA,IAAF;AAAQD,IAAAA;AAAR,MAAiBI,QAAQ,CAAE,iBAAF,CAA/B;;AAEA,QAAMI,SAAS,GAAKC,aAAF,IAAqB,MAAM;AAC5C,QAAKF,QAAQ,EAAb,EAAkB;AACjB,YAAMG,QAAQ,GAAG,wBAAjB;AACAN,MAAAA,QAAQ,CAAE,cAAF,CAAR,CAA2BO,YAA3B,CAAyCD,QAAzC;AACA,aAAON,QAAQ,CAAE,cAAF,CAAR,CAA2BQ,YAA3B,CACN,SADM,EAEN,uDAFM,EAGN;AAAEC,QAAAA,EAAE,EAAEH;AAAN,OAHM,CAAP;AAKA,KARD,MAQO;AACN,aAAOD,aAAa,EAApB;AACA;AACD,GAZD;;AAcA,SAAO;AACNR,IAAAA,IAAI,EAAEO,SAAS,CAAEP,IAAF,CADT;AAEND,IAAAA,IAAI,EAAEQ,SAAS,CAAER,IAAF;AAFT,GAAP;AAIA,CAtB0B,CAAZ,CAsBVL,WAtBU,CAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { withDispatch } from '@wordpress/data';\nimport { KeyboardShortcuts } from '@wordpress/components';\nimport { rawShortcut } from '@wordpress/keycodes';\nimport { BlockEditorKeyboardShortcuts } from '@wordpress/block-editor';\nimport { EditorNotices } from '@wordpress/editor';\n\n/**\n * Internal dependencies\n */\n\nimport VisualEditor from './visual-editor';\nimport TextEditor from './text-editor';\nimport FullscreenMode from './fullscreen-mode';\nimport './style.scss';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n\n/**\n * Undo/redo\n * @callback OnHistory\n */\n\n/**\n * The editor component. Contains the visual or text editor, along with keyboard handling.\n *\n * Note: the keyboard handling is specific to this editor and *not* global\n *\n * @param {object} props - Component props\n * @param {boolean} props.isEditing - Are we editing in this editor?\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {object} props.children - Child components\n * @param {OnHistory} props.undo\n * @param {OnHistory} props.redo\n */\nfunction BlockEditor( props ) {\n\tconst { isEditing, editorMode, children, undo, redo } = props;\n\n\treturn (\n\t\t<>\n\t\t\t<FullscreenMode />\n\t\t\t<EditorNotices />\n\n\t\t\t{ isEditing && (\n\t\t\t\t<>\n\t\t\t\t\t<BlockEditorKeyboardShortcuts />\n\t\t\t\t\t<BlockEditorKeyboardShortcuts.Register />\n\t\t\t\t</>\n\t\t\t) }\n\n\t\t\t<KeyboardShortcuts\n\t\t\t\tbindGlobal={ false }\n\t\t\t\tshortcuts={ {\n\t\t\t\t\t[ rawShortcut.primary( 'z' ) ]: undo,\n\t\t\t\t\t[ rawShortcut.primaryShift( 'z' ) ]: redo,\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ editorMode === 'visual' && <VisualEditor /> }\n\t\t\t\t{ editorMode === 'text' && <TextEditor /> }\n\t\t\t</KeyboardShortcuts>\n\n\t\t\t{ children }\n\t\t</>\n\t);\n}\n\nexport default withDispatch( ( dispatch, _ownProps, { select } ) => {\n\tconst hasPeers = select( 'isolated/editor' ).hasPeers;\n\tconst { redo, undo } = dispatch( 'isolated/editor' );\n\n\tconst maybeUndo = ( actionCreator ) => () => {\n\t\tif ( hasPeers() ) {\n\t\t\tconst noticeId = 'isolated/undo-disabled';\n\t\t\tdispatch( 'core/notices' ).removeNotice( noticeId );\n\t\t\treturn dispatch( 'core/notices' ).createNotice(\n\t\t\t\t'warning',\n\t\t\t\t'Undo/redo is disabled while editing with other users.',\n\t\t\t\t{ id: noticeId }\n\t\t\t);\n\t\t} else {\n\t\t\treturn actionCreator();\n\t\t}\n\t};\n\n\treturn {\n\t\tredo: maybeUndo( redo ),\n\t\tundo: maybeUndo( undo ),\n\t};\n} )( BlockEditor );\n"],"file":"index.js"}