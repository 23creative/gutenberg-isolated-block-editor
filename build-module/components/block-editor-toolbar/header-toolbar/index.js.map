{"version":3,"sources":["../../../../src/components/block-editor-toolbar/header-toolbar/index.js"],"names":["useViewportMatch","useSelect","useDispatch","__","_x","ToolbarItem","Button","Popover","BlockToolbar","NavigableToolbar","BlockNavigationDropdown","__experimentalLibrary","Library","TableOfContents","plus","useRef","EditorHistoryRedo","EditorHistoryUndo","HeaderToolbar","props","inserterButton","setIsInserterOpened","isMobileViewport","select","hasInserterItems","getBlockRootClientId","getBlockSelectionEnd","hasFixedToolbar","isFeatureActive","isInserterEnabled","getEditorMode","getEditorSettings","richEditingEnabled","isTextModeEnabled","previewDeviceType","isInserterOpened","isLargeViewport","settings","iso","toolbar","inserter","toc","navigation","undo","displayBlockToolbar","toolbarAriaLabel","event","preventDefault","current","focus"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __, _x } from '@wordpress/i18n';\nimport { ToolbarItem, Button, Popover } from '@wordpress/components';\nimport {\n\tBlockToolbar,\n\tNavigableToolbar,\n\tBlockNavigationDropdown,\n\t__experimentalLibrary as Library,\n} from '@wordpress/block-editor';\nimport { TableOfContents } from '@wordpress/editor';\nimport { plus } from '@wordpress/icons';\nimport { useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport EditorHistoryRedo from './redo';\nimport EditorHistoryUndo from './undo';\nimport './style.scss';\n\nfunction HeaderToolbar( props ) {\n\tconst inserterButton = useRef();\n\tconst { setIsInserterOpened } = useDispatch( 'isolated/editor' );\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst { hasFixedToolbar, isInserterEnabled, isTextModeEnabled, previewDeviceType, isInserterOpened } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { hasInserterItems, getBlockRootClientId, getBlockSelectionEnd } = select( 'core/block-editor' );\n\n\t\t\treturn {\n\t\t\t\thasFixedToolbar: select( 'isolated/editor' ).isFeatureActive( 'fixedToolbar' ),\n\t\t\t\t// This setting (richEditingEnabled) should not live in the block editor's setting.\n\t\t\t\tisInserterEnabled:\n\t\t\t\t\tselect( 'isolated/editor' ).getEditorMode() === 'visual' &&\n\t\t\t\t\tselect( 'core/editor' ).getEditorSettings().richEditingEnabled &&\n\t\t\t\t\thasInserterItems( getBlockRootClientId( getBlockSelectionEnd() ) ),\n\t\t\t\tisTextModeEnabled: select( 'isolated/editor' ).getEditorMode() === 'text',\n\t\t\t\tpreviewDeviceType: 'Desktop',\n\t\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t\t};\n\t\t},\n\t\t[]\n\t);\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst { inserter, toc, navigation, undo } = props.settings.iso.toolbar;\n\tconst displayBlockToolbar = ! isLargeViewport || previewDeviceType !== 'Desktop' || hasFixedToolbar;\n\tconst toolbarAriaLabel = displayBlockToolbar\n\t\t? /* translators: accessibility text for the editor toolbar when Top Toolbar is on */\n\t\t  __( 'Document and block tools' )\n\t\t: /* translators: accessibility text for the editor toolbar when Top Toolbar is off */\n\t\t  __( 'Document tools' );\n\n\treturn (\n\t\t<NavigableToolbar className=\"edit-post-header-toolbar\" aria-label={ toolbarAriaLabel }>\n\t\t\t{ ( inserter || undo || navigation || toc ) && (\n\t\t\t\t<div className=\"edit-post-header-toolbar__left\">\n\t\t\t\t\t{ inserter && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tref={ inserterButton }\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__inserter-toggle\"\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\tisPressed={ isInserterOpened }\n\t\t\t\t\t\t\tonMouseDown={ ( event ) => {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tif ( isInserterOpened ) {\n\t\t\t\t\t\t\t\t\t// Focusing the inserter button closes the inserter popover\n\t\t\t\t\t\t\t\t\tinserterButton.current.focus();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tsetIsInserterOpened( true );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tdisabled={ ! isInserterEnabled }\n\t\t\t\t\t\t\ticon={ plus }\n\t\t\t\t\t\t\tlabel={ _x( 'Add block', 'Generic label for block inserter button' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isInserterOpened && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tposition=\"bottom right\"\n\t\t\t\t\t\t\tonClose={ () => setIsInserterOpened( false ) }\n\t\t\t\t\t\t\tanchorRef={ inserterButton.current }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Library\n\t\t\t\t\t\t\t\tshowMostUsedBlocks={ false }\n\t\t\t\t\t\t\t\tshowInserterHelpPanel\n\t\t\t\t\t\t\t\tonSelect={ () => {\n\t\t\t\t\t\t\t\t\tif ( isMobileViewport ) {\n\t\t\t\t\t\t\t\t\t\tsetIsInserterOpened( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ undo && <ToolbarItem as={ EditorHistoryUndo } /> }\n\t\t\t\t\t{ undo && <ToolbarItem as={ EditorHistoryRedo } /> }\n\t\t\t\t\t{ navigation && <ToolbarItem as={ BlockNavigationDropdown } isDisabled={ isTextModeEnabled } /> }\n\t\t\t\t\t{ toc && <ToolbarItem as={ TableOfContents } hasOutlineItemsDisabled={ isTextModeEnabled } /> }\n\t\t\t\t</div>\n\t\t\t) }\n\n\t\t\t{ displayBlockToolbar && ! isTextModeEnabled && (\n\t\t\t\t<div className=\"edit-post-header-toolbar__block-toolbar\">\n\t\t\t\t\t<BlockToolbar hideDragHandle />\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</NavigableToolbar>\n\t);\n}\n\nexport default HeaderToolbar;\n"],"file":"index.js"}