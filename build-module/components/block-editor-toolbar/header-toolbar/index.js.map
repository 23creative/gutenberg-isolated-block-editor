{"version":3,"sources":["../../../../src/components/block-editor-toolbar/header-toolbar/index.js"],"names":["useViewportMatch","useSelect","useDispatch","__","_x","ToolbarItem","Button","Popover","NavigableToolbar","BlockNavigationDropdown","__experimentalLibrary","Library","ToolSelector","TableOfContents","plus","listView","useRef","useCallback","store","keyboardShortcutsStore","EditorHistoryRedo","EditorHistoryUndo","preventDefault","event","HeaderToolbar","props","inserterButton","setIsInserterOpened","setIsListViewOpened","isMobileViewport","hasFixedToolbar","isInserterEnabled","isTextModeEnabled","showIconLabels","previewDeviceType","isInserterOpened","isListViewOpen","listViewShortcut","select","hasInserterItems","getBlockRootClientId","getBlockSelectionEnd","isListViewOpened","getShortcutRepresentation","isFeatureActive","getEditorMode","getEditorSettings","richEditingEnabled","isLargeViewport","isWideViewport","inserter","toc","navigation","undo","selectorTool","settings","iso","toolbar","inserterInSidebar","sidebar","displayBlockToolbar","toolbarAriaLabel","openInserter","toggleListView","current","undefined"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __, _x } from '@wordpress/i18n';\nimport { ToolbarItem, Button, Popover } from '@wordpress/components';\nimport {\n\tNavigableToolbar,\n\tBlockNavigationDropdown,\n\t__experimentalLibrary as Library,\n\tToolSelector,\n} from '@wordpress/block-editor';\nimport { TableOfContents } from '@wordpress/editor';\nimport { plus, listView } from '@wordpress/icons';\nimport { useRef, useCallback } from '@wordpress/element';\nimport { store as keyboardShortcutsStore } from '@wordpress/keyboard-shortcuts';\n\n/**\n * Internal dependencies\n */\nimport EditorHistoryRedo from './redo';\nimport EditorHistoryUndo from './undo';\n\nconst preventDefault = ( event ) => {\n\tevent.preventDefault();\n};\n\nfunction HeaderToolbar( props ) {\n\tconst inserterButton = useRef();\n\tconst { setIsInserterOpened, setIsListViewOpened } = useDispatch( 'isolated/editor' );\n\tconst isMobileViewport = useViewportMatch( 'medium', '<' );\n\tconst {\n\t\thasFixedToolbar,\n\t\tisInserterEnabled,\n\t\tisTextModeEnabled,\n\t\tshowIconLabels,\n\t\tpreviewDeviceType,\n\t\tisInserterOpened,\n\t\tisListViewOpen,\n\t\tlistViewShortcut,\n\t} = useSelect( ( select ) => {\n\t\tconst { hasInserterItems, getBlockRootClientId, getBlockSelectionEnd } = select( 'core/block-editor' );\n\t\tconst { isListViewOpened } = select( 'isolated/editor' );\n\t\tconst { getShortcutRepresentation } = select( keyboardShortcutsStore );\n\n\t\treturn {\n\t\t\thasFixedToolbar: select( 'isolated/editor' ).isFeatureActive( 'fixedToolbar' ),\n\t\t\t// This setting (richEditingEnabled) should not live in the block editor's setting.\n\t\t\tisInserterEnabled:\n\t\t\t\tselect( 'isolated/editor' ).getEditorMode() === 'visual' &&\n\t\t\t\tselect( 'core/editor' ).getEditorSettings().richEditingEnabled &&\n\t\t\t\thasInserterItems( getBlockRootClientId( getBlockSelectionEnd() ) ),\n\t\t\tisListViewOpen: isListViewOpened(),\n\t\t\tisTextModeEnabled: select( 'isolated/editor' ).getEditorMode() === 'text',\n\t\t\tpreviewDeviceType: 'Desktop',\n\t\t\tisInserterOpened: select( 'isolated/editor' ).isInserterOpened(),\n\t\t\tshowIconLabels: false, // Not implemented yet\n\t\t\tlistViewShortcut: getShortcutRepresentation( 'core/edit-post/toggle-list-view' ),\n\t\t};\n\t}, [] );\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst isWideViewport = useViewportMatch( 'wide' );\n\tconst { inserter, toc, navigation, undo, selectorTool } = props.settings.iso.toolbar;\n\tconst inserterInSidebar = props.settings?.iso?.sidebar?.inserter || false;\n\tconst displayBlockToolbar = ! isLargeViewport || previewDeviceType !== 'Desktop' || hasFixedToolbar;\n\tconst toolbarAriaLabel = displayBlockToolbar\n\t\t? /* translators: accessibility text for the editor toolbar when Top Toolbar is on */\n\t\t  __( 'Document and block tools' )\n\t\t: /* translators: accessibility text for the editor toolbar when Top Toolbar is off */\n\t\t  __( 'Document tools' );\n\tconst openInserter = useCallback( () => {\n\t\tif ( isInserterOpened ) {\n\t\t\t// Focusing the inserter button closes the inserter popover\n\t\t\t// @ts-ignore\n\t\t\tsetIsInserterOpened( false );\n\t\t} else {\n\t\t\tsetIsInserterOpened( true );\n\t\t}\n\t}, [ isInserterOpened, setIsInserterOpened ] );\n\n\tconst toggleListView = useCallback( () => setIsListViewOpened( ! isListViewOpen ), [\n\t\tsetIsListViewOpened,\n\t\tisListViewOpen,\n\t] );\n\n\treturn (\n\t\t<NavigableToolbar className=\"edit-post-header-toolbar\" aria-label={ toolbarAriaLabel }>\n\t\t\t{ ( inserter || undo || navigation || toc || selectorTool ) && (\n\t\t\t\t<div className=\"edit-post-header-toolbar__left\">\n\t\t\t\t\t{ inserter && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tref={ inserterButton }\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__inserter-toggle\"\n\t\t\t\t\t\t\tisPressed={ isInserterOpened }\n\t\t\t\t\t\t\tonMouseDown={ preventDefault }\n\t\t\t\t\t\t\tonClick={ openInserter }\n\t\t\t\t\t\t\tdisabled={ ! isInserterEnabled }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\ticon={ plus }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16\n\t\t\t\t\tcharacters. */\n\t\t\t\t\t\t\tlabel={ _x( 'Toggle block inserter', 'Generic label for block inserter button' ) }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ isInserterOpened && ! inserterInSidebar && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tposition=\"bottom right\"\n\t\t\t\t\t\t\tonClose={ () => setIsInserterOpened( false ) }\n\t\t\t\t\t\t\tanchorRef={ inserterButton.current }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Library\n\t\t\t\t\t\t\t\tshowMostUsedBlocks={ false }\n\t\t\t\t\t\t\t\tshowInserterHelpPanel\n\t\t\t\t\t\t\t\tonSelect={ () => {\n\t\t\t\t\t\t\t\t\tif ( isMobileViewport ) {\n\t\t\t\t\t\t\t\t\t\tsetIsInserterOpened( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t) }\n\n\t\t\t\t\t{ selectorTool && <ToolSelector /> }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryUndo }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ undo && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ EditorHistoryRedo }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && ! inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem as={ BlockNavigationDropdown } isDisabled={ isTextModeEnabled } />\n\t\t\t\t\t) }\n\t\t\t\t\t{ navigation && inserterInSidebar && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ Button }\n\t\t\t\t\t\t\tclassName=\"edit-post-header-toolbar__list-view-toggle\"\n\t\t\t\t\t\t\ticon={ listView }\n\t\t\t\t\t\t\tdisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\tisPressed={ isListViewOpen }\n\t\t\t\t\t\t\t/* translators: button label text should, if possible, be under 16 characters. */\n\t\t\t\t\t\t\tlabel={ __( 'List View' ) }\n\t\t\t\t\t\t\tonClick={ toggleListView }\n\t\t\t\t\t\t\tshortcut={ listViewShortcut }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ toc && (\n\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\tas={ TableOfContents }\n\t\t\t\t\t\t\thasOutlineItemsDisabled={ isTextModeEnabled }\n\t\t\t\t\t\t\trepositionDropdown={ showIconLabels && ! isWideViewport }\n\t\t\t\t\t\t\tshowTooltip={ ! showIconLabels }\n\t\t\t\t\t\t\tvariant={ showIconLabels ? 'tertiary' : undefined }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</NavigableToolbar>\n\t);\n}\n\nexport default HeaderToolbar;\n"],"file":"index.js"}