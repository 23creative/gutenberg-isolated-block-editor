{"version":3,"sources":["../../../src/components/block-editor-contents/index.js"],"names":["getInitialContent","settings","content","iso","patterns","currentPattern","editor","template","BlockEditorContents","props","blocks","updateBlocksWithoutUndo","updateBlocksWithUndo","selection","isEditing","editorMode","children","renderMoreMenu","onLoad","initialContent","parse","rawHandler","length","select","getBlocks","getEditorSelection","getEditorMode","dispatch"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Popover } from '@wordpress/components';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { useEffect } from '@wordpress/element';\nimport { parse, rawHandler } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport { BlockEditorProvider } from '@wordpress/block-editor';\nimport BlockEditorToolbar from '../block-editor-toolbar';\nimport BlockEditor from '../block-editor';\nimport getInitialEditorContent from './editor-content';\n\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnLoad} OnLoad */\n/** @typedef {import('../../index').OnMore} OnMore */\n\n/**\n * Get editor selection\n * @callback OnSelection\n */\n\n/**\n * Update callback\n * @callback OnUpdate\n * @param {object[]} blocks - Editor content to save\n * @param {object} [options]\n */\n\nfunction getInitialContent( settings, content ) {\n\treturn getInitialEditorContent(\n\t\tsettings.iso.patterns,\n\t\tsettings.iso.currentPattern,\n\t\tsettings.editor.template,\n\t\tcontent\n\t);\n}\n\n/**\n * The editor itself, including toolbar\n *\n * @param {object} props - Component props\n * @param {object[]} props.blocks\n * @param {OnUpdate} props.updateBlocksWithoutUndo - Callback to update blocks\n * @param {OnUpdate} props.updateBlocksWithUndo - Callback to update blocks\n * @param {boolean} props.isEditing - Are we editing in this editor?\n * @param {EditorMode} props.editorMode - Visual or code?\n * @param {object} props.children - Child components\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n * @param {OnSelection} props.selection\n * @param {OnLoad} props.onLoad - Load initial blocks\n */\nfunction BlockEditorContents( props ) {\n\tconst { blocks, updateBlocksWithoutUndo, updateBlocksWithUndo, selection, isEditing, editorMode } = props;\n\tconst { children, settings, renderMoreMenu, onLoad } = props;\n\n\t// Set initial content, if we have any, but only if there is no existing data in the editor (from elsewhere)\n\tuseEffect( () => {\n\t\tconst initialContent = getInitialContent( settings, onLoad ? onLoad( parse, rawHandler ) : [] );\n\n\t\tif ( initialContent.length > 0 && ( ! blocks || blocks.length === 0 ) ) {\n\t\t\tupdateBlocksWithoutUndo( initialContent );\n\t\t}\n\t}, [] );\n\n\treturn (\n\t\t<BlockEditorProvider\n\t\t\tvalue={ blocks || [] }\n\t\t\tonInput={ updateBlocksWithoutUndo }\n\t\t\tonChange={ updateBlocksWithUndo }\n\t\t\tuseSubRegistry={ false }\n\t\t\tselection={ selection }\n\t\t\tsettings={ settings.editor }\n\t\t>\n\t\t\t<BlockEditorToolbar editorMode={ editorMode } settings={ settings } renderMoreMenu={ renderMoreMenu } />\n\t\t\t<BlockEditor isEditing={ isEditing } editorMode={ editorMode }>\n\t\t\t\t{ children }\n\t\t\t</BlockEditor>\n\n\t\t\t<Popover.Slot />\n\t\t</BlockEditorProvider>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getBlocks, getEditorSelection, getEditorMode, isEditing } = select( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tblocks: getBlocks(),\n\t\t\tselection: getEditorSelection(),\n\t\t\tisEditing: isEditing(),\n\t\t\teditorMode: getEditorMode(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { updateBlocksWithUndo, updateBlocksWithoutUndo } = dispatch( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tupdateBlocksWithUndo,\n\t\t\tupdateBlocksWithoutUndo,\n\t\t};\n\t} ),\n] )( BlockEditorContents );\n"],"file":"index.js"}