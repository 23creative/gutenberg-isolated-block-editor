{"version":3,"file":"index.js","names":["SIZE_LARGE","SIZE_MEDIUM","BlockEditorContainer","props","children","settings","className","onError","renderMoreMenu","onLoad","onInput","onChange","blocks","updateBlocksWithoutUndo","isEditorReady","editorMode","isEditing","setEditing","hasFixedToolbar","isPreview","useResizeObserver","resizeListener","width","classes","classnames","useEffect","compose","withSelect","select","getEditorMode","isFeatureActive","isOptionActive","withDispatch","dispatch"],"sources":["../../../src/components/block-editor-container/index.js"],"sourcesContent":["/**\n * External dependencies\n */\n\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { compose, useResizeObserver } from '@wordpress/compose';\nimport { ErrorBoundary } from '@wordpress/editor';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { useEffect } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport ClickOutsideWrapper from './click-outside';\nimport BlockEditorContents from '../block-editor-contents';\nimport HotSwapper from './hot-swapper';\nimport './style.scss';\n\n/** @typedef {import('../../index').BlockEditorSettings} BlockEditorSettings */\n/** @typedef {import('../../index').OnError} OnError */\n/** @typedef {import('../../index').OnMore} OnMore */\n/** @typedef {import('../../store/editor/reducer').EditorMode} EditorMode */\n/** @typedef {import('../../index').OnLoad} OnLoad */\n/** @typedef {import('../block-editor-contents/index').OnUpdate} OnUpdate */\n\n/**\n * Set editing callback\n *\n * @callback OnSetEditing\n * @param {boolean} isEditing\n */\n\nconst SIZE_LARGE = 720;\nconst SIZE_MEDIUM = 480;\n\n/**\n * Contains the block contents. Handles the hot-swapping of the redux stores, as well as applying the root CSS classes\n *\n * @param {Object} props - Component props\n * @param {Object} props.children - Child components\n * @param {boolean} props.isEditorReady - The editor is ready for editing\n * @param {boolean} props.isEditing - This editor is being edited in\n * @param {boolean} props.isPreview - Whether preview mode is enabled\n * @param {boolean} props.hasFixedToolbar - Has fixed toolbar\n * @param {EditorMode} props.editorMode - 'text' or 'visual'\n * @param {string} props.className - additional class names\n * @param {BlockEditorSettings} props.settings - Settings\n * @param {OnError} props.onError - Error callback\n * @param {OnMore} props.renderMoreMenu - Callback to render additional items in the more menu\n * @param {OnSetEditing} props.setEditing - Set the mode to editing\n * @param {OnLoad} props.onLoad - Load initial blocks\n * @param {OnUpdate} props.updateBlocksWithoutUndo - Callback to update blocks\n * @param {OnUpdate} [props.onInput] - Gutenberg's onInput callback\n * @param {OnUpdate} [props.onChange] - Gutenberg's onChange callback\n * @param {object[]} [props.blocks] - Gutenberg's blocks\n */\nfunction BlockEditorContainer( props ) {\n\tconst {\n\t\tchildren,\n\t\tsettings,\n\t\tclassName,\n\t\tonError,\n\t\trenderMoreMenu,\n\t\tonLoad,\n\t\tonInput,\n\t\tonChange,\n\t\tblocks,\n\t\tupdateBlocksWithoutUndo,\n\t} = props;\n\tconst { isEditorReady, editorMode, isEditing, setEditing, hasFixedToolbar, isPreview } = props;\n\tconst [ resizeListener, { width } ] = useResizeObserver();\n\tconst classes = classnames( className, {\n\t\t'iso-editor': true,\n\n\t\t'is-large': width ? width >= SIZE_LARGE : false,\n\t\t'is-medium': width ? width >= SIZE_MEDIUM && width < SIZE_LARGE : true,\n\t\t'is-small': width ? width < SIZE_MEDIUM : false,\n\n\t\t'iso-editor__loading': ! isEditorReady,\n\t\t'iso-editor__selected': isEditing,\n\n\t\t// Match Gutenberg\n\t\t'block-editor': true,\n\t\t'edit-post-layout': true,\n\t\t'has-fixed-toolbar': hasFixedToolbar,\n\t\t[ 'is-mode-' + editorMode ]: true,\n\t\t'is-preview-mode': isPreview,\n\t} );\n\n\tuseEffect( () => {\n\t\t// If blocks are externally provided, update the internal state\n\t\tif ( blocks ) {\n\t\t\tupdateBlocksWithoutUndo( blocks, {} );\n\t\t}\n\t}, [ blocks ] );\n\n\treturn (\n\t\t<div className={ classes }>\n\t\t\t<ErrorBoundary onError={ onError }>\n\t\t\t\t<HotSwapper />\n\n\t\t\t\t{ resizeListener }\n\n\t\t\t\t<ClickOutsideWrapper\n\t\t\t\t\tonOutside={ () => setEditing( false ) }\n\t\t\t\t\tonFocus={ () => ! isEditing && setEditing( true ) }\n\t\t\t\t>\n\t\t\t\t\t<BlockEditorContents\n\t\t\t\t\t\tsettings={ settings }\n\t\t\t\t\t\trenderMoreMenu={ renderMoreMenu }\n\t\t\t\t\t\tonLoad={ onLoad }\n\t\t\t\t\t\tonInput={ onInput }\n\t\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</BlockEditorContents>\n\t\t\t\t</ClickOutsideWrapper>\n\t\t\t</ErrorBoundary>\n\t\t</div>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { isEditorReady, getEditorMode, isEditing, isFeatureActive, isOptionActive } = select(\n\t\t\t'isolated/editor'\n\t\t);\n\n\t\treturn {\n\t\t\tisEditorReady: isEditorReady(),\n\t\t\teditorMode: getEditorMode(),\n\t\t\tisEditing: isEditing(),\n\t\t\thasFixedToolbar: isFeatureActive( 'fixedToolbar' ),\n\t\t\tisPreview: isOptionActive( 'preview' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { setEditing, updateBlocksWithoutUndo } = dispatch( 'isolated/editor' );\n\n\t\treturn {\n\t\t\tsetEditing,\n\t\t\tupdateBlocksWithoutUndo,\n\t\t};\n\t} ),\n] )( BlockEditorContainer );\n"],"mappings":"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"}